<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>pgBackRest - Frequently Asked Questions</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8"></meta><meta property="og:site_name" content="pgBackRest - Reliable PostgreSQL Backup &amp; Restore"></meta><meta property="og:title" content="pgBackRest - Frequently Asked Questions"></meta><meta property="og:type" content="website"></meta><link rel="icon" href="favicon.png" type="image/png"></link><meta property="og:image:type" content="image/png"></meta><meta property="og:image" content="http://www.pgbackrest.org/logo.png"></meta><meta name="description" content="pgBackRest Frequently Asked Questions (FAQ)."></meta><meta property="og:description" content="pgBackRest Frequently Asked Questions (FAQ)."></meta><link rel="stylesheet" href="default.css" type="text/css"></link></head><body><div class="page-header"><div class="page-header-title">pgBackRest</div><div class="page-header-subtitle">Frequently Asked Questions</div></div><div class="page-menu"><div class="menu-body"><div class="menu"><a class="menu-link" href="/">Home</a></div><div class="menu"><a class="menu-link" href="user-guide-index.html">User Guides</a></div><div class="menu"><a class="menu-link" href="release.html">Releases</a></div><div class="menu"><a class="menu-link" href="configuration.html">Configuration</a></div><div class="menu"><a class="menu-link" href="command.html">Commands</a></div><div class="menu"><a class="menu-link" href="metric.html">Metrics</a></div></div></div><div class="page-toc"><div class="page-toc-header"><div class="page-toc-title">Table of Contents</div></div><div class="page-toc-body"><div class="section1-toc"><div class="section1-toc-number">1</div><div class="section1-toc-title"><a href="#introduction">Introduction</a></div></div><div class="section1-toc"><div class="section1-toc-number">2</div><div class="section1-toc-title"><a href="#timeout">What if I get the <q>could not find WAL segment</q> error?</a></div></div><div class="section1-toc"><div class="section1-toc-number">3</div><div class="section1-toc-title"><a href="#manual-expire">How do I manually purge a backup set?</a></div></div><div class="section1-toc"><div class="section1-toc-number">4</div><div class="section1-toc-title"><a href="#optimize-config">How can I configure options independently for each command?</a></div></div><div class="section1-toc"><div class="section1-toc-number">5</div><div class="section1-toc-title"><a href="#s3-bucket">Can I use dots (periods) in my S3 bucket name?</a></div></div><div class="section1-toc"><div class="section1-toc-number">6</div><div class="section1-toc-title"><a href="#old-package">Where can I find packages for older versions of <span class="backrest">pgBackRest</span>?</a></div></div></div></div><div class="page-body"><div class="section1"><a id="introduction"></a><div class="section1-header"><div class="section1-number">1</div><div class="section1-title">Introduction</div></div><div class="section-body"><div class="section-body-text">Frequently Asked Questions are intended to provide details for specific questions that may or may not be covered in the User Guide, Configuration, or Command reference. If you are unable to find details for your specific issue here, remember that the <span class="backrest">pgBackRest</span> <a href="https://github.com/pgbackrest/pgbackrest/issues">Issues List in GitHub</a> is also a valuable resource.</div></div></div><div class="section1"><a id="timeout"></a><div class="section1-header"><div class="section1-number">2</div><div class="section1-title">What if I get the <q>could not find WAL segment</q> error?</div></div><div class="section-body"><div class="section-body-text">The cause of this error can be a result of many different issues, some of which may be:</div><ul class="list-unordered"><li class="list-unordered">misconfigured archive_command</li><li class="list-unordered">misconfigured <span class="backrest">pgBackRest</span> configuration files</li><li class="list-unordered">network or permissions issue</li><li class="list-unordered">third party product (e.g. S3, Swift or Minio) configuration issue</li><li class="list-unordered">large amount of WAL queueing to be archived</li></ul><div class="section-body-text">It is advisable to:</div><ul class="list-unordered"><li class="list-unordered">check the archive_command in <span class="postgres">PostgreSQL</span></li><li class="list-unordered">check the <span class="backrest">pgBackRest</span> configuration settings on each host (e.g. pg* settings are set on the repository host and repo* settings on the pg host)</li><li class="list-unordered">run the <span class="cmd">check</span> command with <span class="br-setting">--archive-timeout</span> set to a higher value than in the <span class="backrest">pgBackRest</span> configuration file (or default) to see if the WAL queue needs more time to clear. If the system is generating a lot of WAL, then consider configuring <a href="https://pgbackrest.org/user-guide.html#async-archiving">asyncronous archiving</a></li></ul></div></div><div class="section1"><a id="manual-expire"></a><div class="section1-header"><div class="section1-number">3</div><div class="section1-title">How do I manually purge a backup set?</div></div><div class="section-body"><div class="section-body-text">Backup sets in the middle cannot be expired, but it is possible to expire the oldest backup sets by running the <span class="cmd">expire</span> command with retention. For example, the following command will keep only the last two full backups, purging any prior full backups including their associated incremental/differential backups and archive:</div><pre class="code-block">pgbackrest --stanza=xxx --repo1-retention-full=2 expire</pre><div class="section-body-text">Using the <span class="br-setting">--repo1-retention-full</span> option on the command- line simply overrides the setting in the configuration file for that one execution of the command. See the <a href="https://pgbackrest.org/user-guide.html#retention">Retention</a> section in the User Guide for more information on retention.</div></div></div><div class="section1"><a id="optimize-config"></a><div class="section1-header"><div class="section1-number">4</div><div class="section1-title">How can I configure options independently for each command?</div></div><div class="section-body"><div class="section-body-text"><span class="backrest">pgBackRest</span> has the ability to set options independently in the configuration file for each command. <a href="https://pgbackrest.org/user-guide.html#quickstart/configure-stanza">Configure Cluster Stanza</a> details this feature as well as option precedence.</div><div class="section-body-text">For example, the <span class="br-option">process-max</span> option can be optimized for each command:</div><pre class="code-block">[global]
# used where not overridden
process-max=2

[global:backup]
# more cores for backup
process-max=4

[global:restore]
# all the cores for restore
process-max=8

[global:archive-push]
# more cores for archive-push
process-max=3

[global:archive-get]
# fewer cores for archive-get
process-max=1</pre></div></div><div class="section1"><a id="s3-bucket"></a><div class="section1-header"><div class="section1-number">5</div><div class="section1-title">Can I use dots (periods) in my S3 bucket name?</div></div><div class="section-body"><div class="section-body-text"><span class="host">RFC-2818</span> does not allow wildcards to match on a dot (.) so s3 bucket names must not contain dots. If there are dots in the S3 bucket name then an error such as <q>unable to find hostname 'my.backup.bucket.s3.amazonaws.com' in certificate common name or subject alternative names</q> will occur.</div></div></div><div class="section1"><a id="old-package"></a><div class="section1-header"><div class="section1-number">6</div><div class="section1-title">Where can I find packages for older versions of <span class="backrest">pgBackRest</span>?</div></div><div class="section-body"><div class="section-body-text">The <a href="https://apt.postgresql.org">apt.postgresql.org</a> repository maintains an <a href="https://atalia.postgresql.org/morgue/p/pgbackrest">archive of older versions</a>. Debian also maintains <a href="https://snapshot.debian.org/binary/pgbackrest/">snapshots</a> of all test builds.</div></div></div></div><div class="page-footer">Copyright &copy; 2015-2019, The PostgreSQL Global Development Group, <a href="https://github.com/pgbackrest/pgbackrest/blob/master/LICENSE">MIT License</a>.  Updated August 5, 2019</div></body></html>